# PostgreSQL configuration file
# Generated by Ansible

{% if postgresql_data_directory %}
# Data directory
data_directory = '{{ postgresql_data_directory }}'
{% endif %}

{% if postgresql_wal_directory %}
# WAL directory
wal_directory = '{{ postgresql_wal_directory }}'
{% endif %}

# Connection and Authentication
listen_addresses = '{{ postgresql_config.listen_addresses }}'
port = {{ postgresql_config.port }}
max_connections = {{ postgresql_config.max_connections }}

# Memory Configuration
shared_buffers = {{ postgresql_config.shared_buffers }}
effective_cache_size = {{ postgresql_config.effective_cache_size }}
maintenance_work_mem = {{ postgresql_config.maintenance_work_mem }}
work_mem = {{ postgresql_config.work_mem }}

# Write-Ahead Logging
wal_buffers = {{ postgresql_config.wal_buffers }}
checkpoint_completion_target = {{ postgresql_config.checkpoint_completion_target }}
min_wal_size = {{ postgresql_config.min_wal_size }}
max_wal_size = {{ postgresql_config.max_wal_size }}

# Query Planner
default_statistics_target = {{ postgresql_config.default_statistics_target }}
random_page_cost = {{ postgresql_config.random_page_cost }}
effective_io_concurrency = {{ postgresql_config.effective_io_concurrency }}

# Logging
{% if postgresql_logging.enabled %}
log_destination = '{{ postgresql_logging.log_destination }}'
logging_collector = {{ 'on' if postgresql_logging.logging_collector else 'off' }}
log_directory = '{{ postgresql_logging.log_directory }}'
log_filename = '{{ postgresql_logging.log_filename }}'
log_rotation_age = {{ postgresql_logging.log_rotation_age }}
log_rotation_size = {{ postgresql_logging.log_rotation_size }}
log_min_duration_statement = {{ postgresql_logging.log_min_duration_statement }}
log_checkpoints = {{ 'on' if postgresql_logging.log_checkpoints else 'off' }}
log_connections = {{ 'on' if postgresql_logging.log_connections else 'off' }}
log_disconnections = {{ 'on' if postgresql_logging.log_disconnections else 'off' }}
log_lock_waits = {{ 'on' if postgresql_logging.log_lock_waits else 'off' }}
log_temp_files = {{ postgresql_logging.log_temp_files }}
log_autovacuum_min_duration = {{ postgresql_logging.log_autovacuum_min_duration }}
{% endif %}

# Locale and Formatting
datestyle = 'iso, mdy'
timezone = '{{ postgresql_default_timezone }}'
lc_messages = '{{ postgresql_default_locale }}'
lc_monetary = '{{ postgresql_default_locale }}'
lc_numeric = '{{ postgresql_default_locale }}'
lc_time = '{{ postgresql_default_locale }}'
default_text_search_config = 'pg_catalog.russian'

# Other Settings
dynamic_shared_memory_type = posix
max_files_per_process = 1000
shared_preload_libraries = ''
